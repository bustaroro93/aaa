======================================================================
   PP_08D - MERGE OPPONENT-ADJUSTED + RENAME A/B
======================================================================
   2026-01-06 22:45:48
======================================================================

[1/4] Loading datasets...
  SOTA: (543927, 1378)
  Opponent-adjusted: (544245, 70)

[2/4] Checking join key...
  SOTA matches: 543,927
  Opp-adj matches: 544,245
  Overlap: 543,927 (100.0%)

[3/4] Renaming winner/loser â†’ A/B...
  Winner columns: 31
  Loser columns: 31

  ğŸ“‹ Rename examples:
     win_rate_vs_top10_winner â†’ win_rate_vs_top10_A
     ace_rate_vs_top10_winner â†’ ace_rate_vs_top10_A
     hold_rate_vs_top10_winner â†’ hold_rate_vs_top10_A
     bp_conv_vs_top10_winner â†’ bp_conv_vs_top10_A
     n_matches_vs_top10_winner â†’ n_matches_vs_top10_A

[4/4] Checking collisions and merging...
  âœ… No column collisions detected
  Before merge: 1378 columns
  After merge: 1447 columns
  New features: +69

  ğŸ“Š Coverage of new features:
     win_rate_vs_top10_A: 16.3%
     win_rate_vs_top50_A: 27.1%
     win_rate_vs_similar_A: 57.5%
     adj_dominance_score_A: 100.0%
     diff_adj_dominance_score: 100.0%

======================================================================
   âœ… PP_08D MERGE COMPLETE!
======================================================================
   Input SOTA: matches_ml_ready_SOTA_v5.parquet
   Input Opp-Adj: opponent_adj_features.parquet
   Output: matches_ml_ready_SOTA_v6.parquet
   New features: +69
   â±ï¸  Time: 10.3s

ğŸ“‹ WHAT HAPPENED:
   âœ… Loaded SOTA_v5 + opponent_adj_features
   âœ… Renamed *_winner â†’ *_A, *_loser â†’ *_B
   âœ… Merged on custom_match_id
   âœ… Saved as SOTA_v6

ğŸ”„ NEXT STEPS:
   1. Update PP_09 to load SOTA_v6 instead of SOTA_v5
   2. Run PP_09 (will now include opponent-adjusted features)
   3. Run PP_10

âš ï¸ IMPORTANT:
   The diff_* columns (e.g., diff_adj_dominance_score) represent A-B.
   PP09 will auto-invert them during shuffle (like other diff* columns).
