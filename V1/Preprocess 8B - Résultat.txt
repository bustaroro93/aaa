======================================================================
   PP_08B - ULTIMATE GOD SOTA FEATURES 2026 v5
   TennisTitan - Markov _B fix + NaN handling
======================================================================
   Timestamp: 2026-01-06 22:40:22
======================================================================

[0/8] Loading best SOTA file...
  âœ… Using: matches_ml_ready_SOTA_v4.parquet
  Shape: (543927, 1337)

[1/8] Adding SRGS features (NASA PRIOR-ONLY)...
  âœ… Using PRIOR: p_srv_pt_prior_A
  âœ… Using PRIOR: p_srv_pt_prior_B
  âœ… SRGS features added (NASA ANTI-LEAK)

[3/8] Adding Intra-Tournament Momentum features...
  rounds_played_approx: âŒ (will create)
  cumulative_fatigue: âŒ (will create)
  round_ta: âœ…
  âœ… round_difficulty created (when/then natif)
  âœ… rounds_played_approx created
  âœ… cumulative_fatigue_index created

[4/8] Adding Form Slope features...
  âœ… form_slope_A from super_tb_serve_win_rate_r5_A, super_tb_serve_win_rate_r20_A
  âœ… form_slope_B from super_tb_serve_win_rate_r5_B, super_tb_serve_win_rate_r20_B

[5/8] Adding Handedness matchup features...
  ğŸ“ Loading handedness from atp_master_players.csv...
     Loaded 8023 players
     Handedness: 7513 Right, 510 Left (6.4% lefties)
     ID columns: winner=winner_id, loser=loser_id
     After merge: 63109 lefties in A, 57041 in B
  âœ… Handedness features added

[6/8] Adding Age-Peak features (NASA-safe STRICT)...
  ğŸ” age_A column: None
  ğŸ” age_B column: None
  âš ï¸ age_at_match_A/B not found - defaulting to null

[7/8] Adding Pressure Differential features...
  âœ… clutch_differential_A added
  âœ… clutch_differential_B added

[8/8] Adding Round features...
  âœ… Round features added

======================================================================
   âœ… PP_08 v5 COMPLETE!
======================================================================
   Input: matches_ml_ready_SOTA_v4.parquet (1337 cols)
   Output: matches_ml_ready_SOTA_v5.parquet (1378 cols)
   New features: +41
   â±ï¸  Time: 8.5s

ğŸ“Š GOD SOTA FEATURES ADDED:
   âœ… SRGS: 3 features
   âœ… Markov: 32 features
   âœ… Momentum: 45 features
   âœ… Form Slope: 3 features
   âœ… Handedness: 1 features
   âœ… Age-Peak: 10 features
   âœ… Clutch: 18 features
   âœ… Round: 4 features

ğŸ“‹ MARKOV PAIRING CHECK:
   _A features: 10 â†’ ['markov_p_point_srv_A', 'markov_p_point_srv_vs_opp_A', 'markov_p_point_srv_blend_A', 'markov_p_hold_A', 'markov_p_break_A', 'markov_p_set_tb12_A', 'markov_p_match_bo3_A', 'markov_p_match_bo5_A', 'markov_p_match_markov_A', 'markov_match_key_A']
   _B features: 10 â†’ ['markov_p_point_srv_B', 'markov_p_point_srv_vs_opp_B', 'markov_p_point_srv_blend_B', 'markov_p_hold_B', 'markov_p_break_B', 'markov_p_set_tb12_B', 'markov_p_match_bo3_B', 'markov_p_match_bo5_B', 'markov_p_match_markov_B', 'markov_match_key_B']
   âœ… Markov features properly paired!

ğŸ“‹ CORRECTIONS v5:
   âœ… Markov: Ajout des versions _B (p_set_B, p_match_B, edge_B)
   âœ… fill_nan() + fill_null() partout
   âœ… when/then natif
   âœ… DÃ©tection dynamique IDs