======================================================================
   TENNISTITAN 2026 - PREPROCESS 2 GOD MODE (Polars)
======================================================================
============================================================
CELLULE A - PCT NORMALIZE (Polars)
============================================================
[pct-normalize] loaded matches_base: 544,245 rows
[pct-normalize] 7,207,608 NaN convertis en null
[pct-normalize] 0 colonnes scalÃ©es 0-100â†’0-1
[pct-normalize] scaled columns: []
[partition] gender = 'atp'
[partition] year = 1942
âœ” matches_base_scaled â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\matches_base_scaled
============================================================
CELLULE B - FIX 2NDWON_P (Polars)
============================================================
[2ndWon_fix] loaded: 544,245 rows
w_s_2ndWon_p: non-null=186,125 | min=0.000 | p50=0.556 | max=1.000
         -> recalc=34.2% | fallback=0.0%
l_s_2ndWon_p: non-null=178,283 | min=0.000 | p50=0.447 | max=1.000
         -> recalc=32.7% | fallback=0.0%
w_ret_2ndWon_p: non-null=207,940 | min=0.000 | p50=0.556 | max=1.000
         -> recalc=32.7% | fallback=5.5%
l_ret_2ndWon_p: non-null=207,948 | min=0.000 | p50=0.444 | max=1.000
         -> recalc=34.2% | fallback=4.0%
[partition] gender = 'atp'
[partition] year = 1942
âœ” 2ndWon_p fixed â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\matches_base_scaled
============================================================
CELLULE C - SURFACE SPEED INDEX (Polars)
============================================================
âœ” surface_speed_index (SOTA Time-Correct) â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\aux_data\surface_speed_index.parquet
  Lignes: 21,992
  Tournois uniques: 5800
  AnnÃ©es couvertes: 1942 - 2025
============================================================
CELLULE D - GLICKO-2 RATINGS (Polars I/O)
============================================================
[sort] SOTA: match_sequence_key
[glicko2] Processing 522,120 matches...
  [glicko2] 50,000 / 522,120 matchs traitÃ©s (9.6%)
  [glicko2] 100,000 / 522,120 matchs traitÃ©s (19.2%)
  [glicko2] 150,000 / 522,120 matchs traitÃ©s (28.7%)
  [glicko2] 200,000 / 522,120 matchs traitÃ©s (38.3%)
  [glicko2] 250,000 / 522,120 matchs traitÃ©s (47.9%)
  [glicko2] 300,000 / 522,120 matchs traitÃ©s (57.5%)
  [glicko2] 350,000 / 522,120 matchs traitÃ©s (67.0%)
  [glicko2] 400,000 / 522,120 matchs traitÃ©s (76.6%)
  [glicko2] 450,000 / 522,120 matchs traitÃ©s (86.2%)
  [glicko2] 500,000 / 522,120 matchs traitÃ©s (95.8%)
âœ” glicko2 post-clean: dup enlevÃ©s=0
[partition] gender = 'atp'
[partition] year = 2006
âœ” glicko2 features â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\features\ratings_glicko2
  Lignes: 1,044,240
============================================================
CELLULE E - CHARTING SUPER FEATURES SOTA (Polars)
============================================================
[charting] Loaded: 13,278,337 rows
[charting] Aggregating features per match (SOTA)...
[charting] Per-match features: 14,369 rows
[charting] doublons supprimÃ©s: 0
[partition] gender = 'atp'
[partition] year = 2020
âœ” charting_super SOTA â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\features\charting_super
  Lignes: 14,369
  Features rolling: 48
  Flags historiques: 6
============================================================
CELLULE F - H2H DECAY (Polars I/O)
============================================================
[h2h] Processing 522,120 matches...
  [h2h] 50,000 / 522,120 matchs traitÃ©s (9.6%)
  [h2h] 100,000 / 522,120 matchs traitÃ©s (19.2%)
  [h2h] 150,000 / 522,120 matchs traitÃ©s (28.7%)
  [h2h] 200,000 / 522,120 matchs traitÃ©s (38.3%)
  [h2h] 250,000 / 522,120 matchs traitÃ©s (47.9%)
  [h2h] 300,000 / 522,120 matchs traitÃ©s (57.5%)
  [h2h] 350,000 / 522,120 matchs traitÃ©s (67.0%)
  [h2h] 400,000 / 522,120 matchs traitÃ©s (76.6%)
  [h2h] 450,000 / 522,120 matchs traitÃ©s (86.2%)
  [h2h] 500,000 / 522,120 matchs traitÃ©s (95.8%)
[h2h] doublons supprimÃ©s: 0
[partition] gender = 'atp'
[partition] year = 2013
âœ” h2h_decay â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\features\h2h_decay
  Lignes: 1,044,240
============================================================
CELLULE G - BASELINE MARKOV (Polars)
============================================================
[markov] Computing Markov probabilities for 1,087,942 rows...
[markov] doublons supprimÃ©s: 0
[partition] gender = 'atp'
[partition] year = 2018
âœ” baseline_markov â†’ C:\Users\Administrateur\Tennis POLAR v3\data_clean\features\baseline_markov
  Lignes: 1,087,942

============================================================
SANITY CHECK PREPROCESS2 (Polars)
============================================================
[2ndWon_p] w_s_2ndWon_p: non_null=186,125 | null=358,120 | nan=0 | inf=0 | out01=0
           -> recalc=34.2% | fallback=0.0%
[2ndWon_p] l_s_2ndWon_p: non_null=178,283 | null=365,962 | nan=0 | inf=0 | out01=0
           -> recalc=32.7% | fallback=0.0%
[2ndWon_p] w_ret_2ndWon_p: non_null=207,940 | null=336,305 | nan=0 | inf=0 | out01=0
           -> recalc=32.7% | fallback=5.5%
[2ndWon_p] l_ret_2ndWon_p: non_null=207,948 | null=336,297 | nan=0 | inf=0 | out01=0
           -> recalc=34.2% | fallback=4.0%
âœ” glicko2: 1,044,240 rows, pas de doublons, RD OK
âœ” charting_super: 14,369 rows, flags=6, rolling=48
âœ” h2h: 1,044,240 rows, pas de doublons, rates OK
âœ” markov time-freeze: 98.7% NaN sur premiers matchs
âœ” markov: 1,087,942 rows, pas de doublons, probs OK
âœ” SSI: 21,992 rows

âœ… SANITY CHECK PASSED

======================================================================
   ğŸ“Š RÃ‰SUMÃ‰ PREPROCESS 2 GOD MODE
======================================================================
   â±ï¸  Temps total: 646.4s

   ğŸ“‚ Outputs:
      âœ… matches_base_scaled
      âœ… ratings_glicko2
      âœ… charting_super
      âœ… h2h_decay
      âœ… baseline_markov
      âœ… surface_speed_index

======================================================================
   ğŸ¯ PREPROCESS 2 GOD MODE COMPLETE
======================================================================